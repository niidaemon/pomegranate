# ===================================================================
# pgBackRest Configuration
# ===================================================================
# Purpose:
#   Define backup and restore settings for PostgreSQL using pgBackRest.
#   Includes global repository settings and stanza-specific configuration.
# ===================================================================

[global]
# -------------------------------------------------------------------
# Repository Settings
# -------------------------------------------------------------------
repo1-path=/backup/pgbackrest          # Path where backups are stored
repo1-retention-full=7                 # Keep 7 full backups
repo1-retention-diff=2                 # Keep 2 differential backups
repo1-cipher-type=aes-256-cbc          # Encryption algorithm
repo1-cipher-pass=${BACKUP_ENCRYPTION_KEY}  # Encryption key (from env var)

# -------------------------------------------------------------------
# Logging
# -------------------------------------------------------------------
log-level-console=info                 # Console log verbosity
log-level-file=debug                   # File log verbosity
log-path=/var/log/pgbackrest           # Log file directory

# -------------------------------------------------------------------
# Performance
# -------------------------------------------------------------------
process-max=4                          # Max parallel processes
compress-type=lz4                      # Compression algorithm

# ===================================================================
# STANZA: main
# -------------------------------------------------------------------
# A stanza defines a PostgreSQL cluster to back up.
# ===================================================================
[main]
pg1-path=/var/lib/postgresql/data      # Data directory of PostgreSQL
pg1-port=5432                          # PostgreSQL port
pg1-user=postgres                      # PostgreSQL superuser
pg1-database=postgres                  # Default database for connection
